@model OpenIDApp.Models.ExamChromosome
@{
    ViewData["Title"] = "Lịch thi tối ưu (GA)";
    var subjects = ViewBag.SubjectDict as Dictionary<int, string>;
    var rooms = ViewBag.RoomDict as Dictionary<int, string>;
}

<h2 class="mb-3">Lịch thi tối ưu (Thuật toán di truyền)</h2>

@if (Model == null || Model.Genes == null || Model.Genes.Count == 0)
{
    <div class="alert alert-warning">Không có dữ liệu để hiển thị.</div>
}
else
{
    <div class="mb-2">
        <strong>Fitness:</strong> @Model.Fitness
    </div>

    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>#</th>
                <th>Môn</th>
                <th>Phòng</th>
                <th>Bắt đầu</th>
                <th>Thời lượng (phút)</th>
            </tr>
        </thead>
        <tbody>
        @{
            var i = 1;
            foreach (var g in Model.Genes.OrderBy(x => x.StartTime))
            {
                var subjectName = subjects != null && subjects.ContainsKey(g.SubjectId) ? subjects[g.SubjectId] : $"Subject #{g.SubjectId}";
                var roomName = rooms != null && rooms.ContainsKey(g.RoomId) ? rooms[g.RoomId] : $"Room #{g.RoomId}";
                <tr>
                    <td>@i</td>
                    <td>@subjectName</td>
                    <td>@roomName</td>
                    <td>@g.StartTime.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>@g.DurationMinutes</td>
                </tr>
                i++;
            }
        }
        </tbody>
    </table>

    <div class="mt-3">
        <a class="btn btn-secondary" asp-action="Index" asp-controller="Admin">Quay lại Dashboard</a>
        @* TODO: Thêm nút "Lưu vào DB" ở bước sau *@
    </div>
}
